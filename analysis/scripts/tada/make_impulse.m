function pulse = make_impulse (f0,srate, frame_dur,AV, tot_dur)if nargin < 4, AV = ones(1, length(f0)); endif nargin >= 4 & length(f0) == 1    f0(1:length(AV)) = f0;endsamps_per_frame = floor((frame_dur/1000)*srate);i = 1;next_frame = 1;samples = 1;while next_frame <= length(f0)	pulse(samples) = AV(next_frame);	period(i) = fix((1/f0(next_frame))*srate);	samples = samples + period(i);	next_frame = ceil(samples/samps_per_frame);	i = i+1;end% when total samples and generated samples mismatch at finaltot_samps = tot_dur*srate;cur_samps = length(pulse);if tot_samps > cur_samps    pulse = [pulse zeros(1, tot_samps - cur_samps)];end